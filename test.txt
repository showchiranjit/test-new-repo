// src/components/OrderForm.js
import React, { useState } from 'react';
import axios from 'axios';

const OrderForm = () => {
    const [orderId, setOrderId] = useState('');
    const [storeId, setStoreId] = useState('');
    const [latitude, setLatitude] = useState('');
    const [longitude, setLongitude] = useState('');
    const [error, setError] = useState('');
    const [success, setSuccess] = useState('');

    const handleSubmit = async (e) => {
        e.preventDefault();
        setError('');
        setSuccess('');

        const url = 'https://stride-request-manager.stg.walmart.com/kafka-listener/fms/order';
        const headers = {
            'Content-Type': 'application/json',
            'x-userId': 'a0p040w',
            'x-tenantId': 'US',
            'x-domain': 'USLM',
            'x-correlationId': '12345',
            'tenantId': '0'
        };

        const payload = {
            header: {
                businessUnitId: "0",
                martId: "0",
                schemaVersionNo: "1",
                eventName: "FULFILLMENT_ORDER_CREATED",
                eventAction: "CREATED",
                eventSource: "FMS",
                eventID: "62732b75-2009-4e5e-80af-586c4add774c",
                eventTime: new Date().toISOString(),
                timestamp: Date.now().toString(),
                payloadVersion: "MQ",
                orderSource: "USOMS",
                eventTxnDate: new Date().toISOString()
            },
            payload: {
                modifiedDate: new Date().toISOString(),
                sourceOrderId: orderId,
                customerOrderId: orderId,
                orderPlacedTimestamp: new Date().toISOString(),
                fulfillmentRequest: {
                    fulfillmentRequestId: `US|${orderId}`
                },
                fulfillmentOrder: [
                    {
                        createdAt: new Date().toISOString(),
                        modifiedDate: new Date().toISOString(),
                        purchaseOrderNo: orderId,
                        tCNumber: "007371137272833806137",
                        shipNode: {
                            id: storeId,
                            name: "Bentonville Neighborhood Market",
                            type: "STORE",
                            timeZone: "CST",
                            storeId: "4376",
                            wmReferenceNumber: "04376",
                            forceShipNode: false,
                            postalCode: "72712"
                        },
                        isFoCancelled: false,
                        sourcingDetails: {
                            shipNode: storeId,
                            carrierMethodId: "1000",
                            orderProcessingDate: "2023-02-06T05:57:00+00:00",
                            preciseDeliveryDate: "2023-02-06T22:59:00+00:00",
                            expectedShipDate: "2023-02-06T05:30:00+00:00",
                            orderCutOff: "2023-02-07T00:00:00+00:00",
                            minPromiseDeliveryDate: "2023-02-06T22:59:00+00:00",
                            maxPromiseDeliveryDate: "2023-02-06T22:59:00+00:00",
                            minExpectedShipDate: "2023-02-06T05:30:00+00:00",
                            maxExpectedShipDate: "2023-02-06T05:30:00+00:00",
                            xmlCarrierMethodId: "1000"
                        },
                        carrierMethodId: "1000",
                        poManagedBy: "FMS",
                        poPublishedBy: "FMS",
                        fulfillmentOrderLines: [
                            {
                                fulfillerLineId: "1",
                                sellerLineId: "14",
                                sourceLineSecondaryId: "14",
                                quantity: {
                                    unitOfMeasure: "EA",
                                    measurementValue: 1
                                },
                                itemDetails: {
                                    walmartItemNumber: "575370552",
                                    upc: "058449450610",
                                    wupc: "0005844945061",
                                    gtin: "00058449450610",
                                    sku: "00058449450610",
                                    itemDesc: "Nature's Path Organic Instant Oatmeal, Gluten Free, Brown Sugar Maple, 1.41 oz, 8 Packets",
                                    legacyItemId: "32214774",
                                    legacySellerId: "0",
                                    offerId: "B9F1F129D6074D61BB08AEE0879024F0",
                                    imageUrl: "https://i5.walmartimages.com/asr/cbb1ad4e-5ed0-4413-b2b5-8e687a81fac1.d9d90eeb0e37fc5b0377798c2a9d616b.png",
                                    isAgeVerificationRequired: false
                                },
                                fulfillmentOrderLineQtyStatus: [
                                    {
                                        modifiedDate: new Date().toISOString(),
                                        currentStatus: "PO Created",
                                        quantity: {
                                            unitOfMeasure: "EA",
                                            measurementValue: 1
                                        },
                                        intentToCancel: false,
                                        statusCode: "1000",
                                        isReshop: false,
                                        reshop: false
                                    }
                                ],
                                wfsEnabled: false,
                                chargeDetails: [
                                    {
                                        chargeName: "ItemPrice",
                                        chargePerUnit: {
                                            currencyAmount: 4.42,
                                            currencyUnit: "USD"
                                        },
                                        chargePerLine: {
                                            currencyAmount: 4.42,
                                            currencyUnit: "USD"
                                        },
                                        isDiscount: false,
                                        taxDetails: {
                                            taxPerUnit: {
                                                currencyAmount: 0.14,
                                                currencyUnit: "USD"
                                            },
                                            taxPerLine: {
                                                currencyAmount: 0.14,
                                                currencyUnit: "USD"
                                            }
                                        },
                                        isBillable: false
                                    }
                                ],
                                lineAttributeList: [
                                    {
                                        attributeName: "maxPromisedDate",
                                        values: ["2023-02-06T22:59:00Z"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "IsHazmat",
                                        values: ["N"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "checkoutGroupLine",
                                        values: ["14"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isEventActive",
                                        values: ["false"],
                                        type: "BOOLEAN"
                                    },
                                    {
                                        attributeName: "isAml",
                                        values: ["N"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "Reshopped",
                                        values: ["false"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isBulkBuy",
                                        values: ["false"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "salesUOM",
                                        values: ["Each"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "lineType",
                                        values: ["STORE"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "accEligible",
                                        values: ["N"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "SnapEligible",
                                        values: ["true"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "sku",
                                        values: ["00058449450610"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isUnscheduled",
                                        values: ["Y"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "brandName",
                                        values: ["Nature's Path"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "minPromisedDate",
                                        values: ["2023-02-06T22:59:00Z"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isItemEligibleForSubstitution",
                                        values: ["true"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isUnScheduled",
                                        values: ["true"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "RHPath",
                                        values: ["40000:42000:42003:42104:42225"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "OverrideIROPrice",
                                        values: ["N"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isCancellable",
                                        values: ["true"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "PrimaryItemID",
                                        values: ["32214774"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "offerPurchaseType",
                                        values: ["BUY-NEW"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isVariantReplacement",
                                        values: ["false"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isEligibleForAssociateDiscount",
                                        values: ["false"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "SupplierItem",
                                        values: ["00058449450610"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "isAlcohol",
                                        values: ["false"],
                                        type: "BOOLEAN"
                                    },
                                    {
                                        attributeName: "ItemClassId",
                                        values: ["1"],
                                        type: "STRING"
                                    },
                                    {
                                        attributeName: "shipTogetherID",
                                        values: [null],
                                        type: "STRING"
                                    }
                                ],
                                fulfillmentPrerequisites: {
                                    preRequisiteList: ["MIN_JIFFYBAG_PROTECTION_REQUIRED"]
                                },
                                fulfillmentOrderLineId: "1",
                                primeLineFulfillerLineKey: "14-1",
                                sellerId: "F55CDC31AB754BB68FE0B39041159D63",
                                partnerItemId: "00058449450610",
                                productName: "Nature's Path Organic Instant Oatmeal, Gluten Free, Brown Sugar Maple, 1.41 oz, 8 Packets",
                                shippingProgramType: "DELIVERY",
                                shippingSLATier: "ONE_DAY",
                                sellerDetails: {},
                                lineTotal: {
                                    currencyAmount: 4.56,
                                    currencyUnit: "USD"
                                },
                                tnt: "0",
                                unscheduled: true
                            }
                        ],
                        destSpecification: {
                            dpv: "Y",
                            cmra: "N",
                            usCarrierRouteCode: "R016",
                            postalCode: "72714",
                            addressType: "RESIDENTIAL"
                        },
                        shippingTo: {
                            contact: {
                                name: {
                                    firstName: "Kelly",
                                    lastName: "Parks"
                                },
                                phone: "4799258279",
                                email: "kelly10385@yahoo.com"
                            },
                            address: {
                                line1: "1624-1630 Louisville St",
                                apoFpo: false,
                                poBox: false,
                                city: "Starkville",
                                state: "MS",
                                country: "USA",
                                zip: "39759",
                                latitude: parseFloat(latitude),
                                longitude: parseFloat(longitude),
                                extendedPostalCode: "727141726",
                                addressType: "RESIDENTIAL"
                            }
                        },
                        isReshop: false,
                        instruction: [
                            {
                                instructionType: "DELIVERY",
                                instructionSubType: "LEAVE_AT_DOOR"
                            }
                        ],
                        nodeType: "STORE",
                        accessType: "DELIVERY_ADDRESS",
                        accessMode: "LAST_MILE_CARRIER",
                        segment: "oaoh",
                        slaSpeed: "ONE_DAY",
                        fulfillmentType: "DELIVERY",
                        storeId: "4376",
                        totals: {
                            subtotal: {
                                currencyAmount: 4.42,
                                currencyUnit: "USD"
                            },
                            tax: {
                                currencyAmount: 0.14,
                                currencyUnit: "USD"
                            },
                            grandTotal: {
                                currencyAmount: 4.56,
                                currencyUnit: "USD"
                            }
                        },
                        boxingDetails: [
                            {
                                boxSequence: 1,
                                boxInstanceId: "S11|1862252d128|1456",
                                boxName: "S11",
                                boxType: "BOX",
                                boxDimensions: {
                                    length: 16.0,
                                    breadth: 14.0,
                                    height: 12.0
                                },
                                weight: {
                                    measurementValue: 2.5662000000000003
                                },
                                lineDetails: [
                                    {
                                        fulfillmentLineId: 1,
                                        quantity: {
                                            measurementValue: 1
                                        }
                                    }
                                ]
                            }
                        ],
                        isGift: false,
                        isMultiHop: false,
                        membershipInfo: {
                            isWplusMember: true,
                            membershipId: "dda3a2a4-37c6-4fb0-99b6-88bf0208d36c",
                            program: "WALMART_PLUS",
                            membershipStatus: "active",
                            memberBenefits: [
                                "CASHBACK",
                                "DELIVERY_UNLIMITED",
                                "EARLY_ACCESS",
                                "FREE_SHIPPING",
                                "ITEM_REWARDS",
                                "LMD_FREE_RETURNS",
                                "SCAN_N_GO",
                                "STREAMING",
                                "SUBSCRIPTION",
                                "W_FUEL"
                            ]
                        },
                        customerId: "f20433d6-3131-5f2e-e044-001517f43a86",
                        smartStagingOrderEnabled: true,
                        smartStagingPOCutOffTime: 1675724400000,
                        dispenseCutOffTime: 0,
                        arrivalShapingStartTime: 0,
                        arrivalShapingEndTime: 0,
                        isEventActive: false,
                        customer: {
                            name: {
                                firstName: "Mohammad",
                                lastName: "Shahid"
                            },
                            phone: "99889912",
                            email: "md.shahid@wal-mt.com"
                        },
                        reshop: false
                    }
                ]
            }
        };

        try {
            const response = await axios.post(url, payload, { headers });
            setSuccess('Order posted successfully!');
            console.log('Order posted successfully:', response.data);
        } catch (error) {
            setError('Error posting order: ' + error.message);
            console.error('Error posting order:', error);
        }
    };

    return (
        <form onSubmit={handleSubmit} className="p-4 space-y-4">
            <div>
                <label className="block text-sm font-medium text-gray-700">Order ID</label>
                <input
                    type="text"
                    value={orderId}
                    onChange={(e) => setOrderId(e.target.value)}
                    className="mt-1 block w-full border border-gray-300 rounded-md p-2"
                    required
                />
            </div>
            <div>
                <label className="block text-sm font-medium text-gray-700">Store ID</label>
                <input
                    type="text"
                    value={storeId}
                    onChange={(e) => setStoreId(e.target.value)}
                    className="mt-1 block w-full border border-gray-300 rounded-md p-2"
                    required
                />
            </div>
            <div>
                <label className="block text-sm font-medium text-gray-700">Latitude</label>
                <input
                    type="text"
                    value={latitude}
                    onChange={(e) => setLatitude(e.target.value)}
                    className="mt-1 block w-full border border-gray-300 rounded-md p-2"
                    required
                />
            </div>
            <div>
                <label className="block text-sm font-medium text-gray-700">Longitude</label>
                <input
                    type="text"
                    value={longitude}
                    onChange={(e) => setLongitude(e.target.value)}
                    className="mt-1 block w-full border border-gray-300 rounded-md p-2"
                    required
                />
            </div>
            <button type="submit" className="w-full bg-blue-500 text-white p-2 rounded-md">Submit Order</button>
            {error && <p className="text-red-500">{error}</p>}
            {success && <p className="text-green-500">{success}</p>}
        </form>
    );
};

export default OrderForm;
